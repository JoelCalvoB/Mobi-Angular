<div class="row barrasuperior mb-5 ml-2 mr-2">
  <div class="col titulo-outlet">
    <button (click)="mostrarmenu()" class="btn-menu"><i  class="bi bi-list"></i></button>
       <label>REGISTRAR NUEVO CLIENTE</label>
  </div>
</div>


<main class="miformulario">
	<div class="form-wrap">

		<form [formGroup]="myForm" (ngSubmit)="enviar()" id="survey-form">
      <div class="row mb-2" >
        <div class="col-12">
          <h2 id="title" class="fw-bold text-secondary">Registrar nuevo cliente</h2>
        </div>
      </div>
      <mat-divider></mat-divider>
      <div class="row">
        <div class="col-12">
          <h3 id="title" class="fw-bold text-secondary">Logo de la empresa (opcional)</h3>
        </div>
      </div>
      <div class="row mb-3 ">
        <div class="col-md-6 text-center">

          <app-subirarchivo formControlName="foto" [titulo]="'Seleccionar logo'"></app-subirarchivo>
          <mat-error *ngIf="f['foto'].invalid && f['foto'].touched">Campo obligatorio</mat-error>
        </div>
        <div style="border-left: 1px solid rgb(181, 181, 181);" class="col-md-6 text-start">

          <div class="row">
            <div class="col-12">
              <h3 id="title" class="fw-bold text-secondary">Seleccionar color marca</h3>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <mat-form-field class="example-form-field"  color="primary">
                <mat-label>Color primario</mat-label>
                <input matInput type="color" formControlName="colorprimario" >
              </mat-form-field>
            </div>
            <div class="col-md-12">
              <mat-form-field class="example-form-field"  color="primary">
                <mat-label>Color secundario</mat-label>
                <input matInput type="color" formControlName="colorsecundario" >
              </mat-form-field>
            </div>
            <div class="col-12 text-start">
              <button (click)="vistaPrevia()" type="button" mat-button type="button" mat-raised-button color="{{!vista?'primary':'accent'}}" >{{!vista?'Vista Previa':'Cancelar'}}</button>
            </div>
          </div>
        </div>
      </div>
      <mat-divider></mat-divider>
      <div class="row">
        <div class="col-12">
          <h3 id="title" class="fw-bold text-secondary">Datos del cliente</h3>
        </div>
      </div>
			<div class="row">
				<div class="col-md-6">
          <mat-form-field class="example-form-field"  color="primary">
            <mat-label>Nombre cliente</mat-label>
            <input matInput type="text" formControlName="nombre" >
            <mat-error *ngIf="f['nombre'].invalid && f['nombre'].touched">Campo obligatorio</mat-error>
          </mat-form-field>
				</div>
        <div class="col-md-6">
          <mat-form-field class="example-form-field"  color="primary">
            <mat-label>RFC</mat-label>
            <input matInput type="text" formControlName="rfc" >
            <mat-error *ngIf="f['rfc'].invalid && f['rfc'].touched">Campo obligatorio</mat-error>
          </mat-form-field>
				</div>
        <div class="col-md-6">
          <mat-form-field class="example-form-field"  color="primary">
            <mat-label>Razón social</mat-label>
            <input matInput type="text" formControlName="razonSocial" >
            <mat-error *ngIf="f['razonSocial'].invalid && f['razonSocial'].touched">Campo obligatorio</mat-error>
          </mat-form-field>
				</div>
        <div class="col-md-6">
          <mat-form-field>
            <mat-label>Versiones</mat-label>
            <mat-select formControlName="version" multiple>
              <mat-select-trigger>
                {{f["version"].value?.[0] || ''}}
                <span *ngIf="(f['version'].value?.length || 0) > 1" class="example-additional-selection">
                  (+{{(f['version'].value?.length || 0) - 1}} {{f['version'].value?.length === 2 ? 'Otro' : 'Otros'}})
                </span>
              </mat-select-trigger>
              <mat-option *ngFor="let version of usuario.rol.empresas.versiones" [value]="version.idVersion">{{version.nombre}}</mat-option>
            </mat-select>
            <mat-error *ngIf="f['version'].invalid && f['version'].touched">Campo obligatorio</mat-error>
          </mat-form-field>
        </div>
        <div class="col-md-6">
          <mat-checkbox class="example-margin" formControlName="esCliente">Es cliente</mat-checkbox>
				</div>



			</div>
      <mat-divider></mat-divider>

      <div class="row mt-4">
        <div class="col-12">
          <mat-accordion>
            <mat-expansion-panel hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  Contacto inicial
                </mat-panel-title>
                <mat-panel-description>
                  Usuario que iniciara sesión en la empresa
                </mat-panel-description>
              </mat-expansion-panel-header>
              <div class="col-md-8">
                <mat-form-field style="width: 100%;">
                  <mat-label>Seleccionar usuario</mat-label>
                  <mat-select formControlName="usuarios" multiple>
                    <mat-select-trigger>
                      {{f["usuarios"].value?.[0] || ''}}
                      <span *ngIf="(f['usuarios'].value?.length || 0) > 1" class="example-additional-selection">
                        (+{{(f['usuarios'].value?.length || 0) - 1}} {{f['usuarios'].value?.length === 2 ? 'Otro' : 'Otros'}})
                      </span>
                    </mat-select-trigger>
                    <mat-option *ngFor="let user of usuarios" [value]="user.id">{{user.correo + ' '+user.nombre}}</mat-option>
                  </mat-select>
                  <mat-error *ngIf="f['usuarios'].invalid && f['usuarios'].touched">Campo obligatorio</mat-error>
                </mat-form-field>
              </div>
            </mat-expansion-panel>
          </mat-accordion>
        </div>
      </div>


		<footer *ngIf="!vista">
      <div class="row mt-5">
				<div class="col-12 text-end">
          <button (click)="cancelar()" type="button" mat-button type="submit" color="accent">Cancelar</button>
          <button mat-button type="submit" color="primary">Guardar</button>
				</div>
			</div>
    </footer>

		</form>
	</div>
</main>
